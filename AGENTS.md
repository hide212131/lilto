# AGENTS.md

## ドキュメント言語ルール
- このリポジトリで作成・更新する Markdown（`.md`）は、原則として日本語で記述する。
- 見出し、本文、注釈、タスクリスト、提案文は日本語で書く。
- コード、コマンド、識別子、API名、ライブラリ名、ファイルパスなどは英語のままでよい。
- 既存の英語Markdownを更新する場合は、更新箇所を日本語に統一する。

## 開発参照
- 開発を進める際、必要に応じて Pi のコードを参照する。
- Pi リポジトリの場所は `.env` の `PI_REPO_DIR` に記載されている。

## ワークフローのオーケストレーション

### 自己改善ループ

* ユーザーから**どんな**修正が入っても、決まった型で `tasks/lessons.md` を更新する
* 同じミスを防ぐためのルールを自分向けに書く
* ミスの割合が下がるまで、これらの学びを容赦なく反復する
* そのセッションで関係するプロジェクトのために、開始時に学びを見直す

### 完了前の検証

* 動くことを証明するまでは、タスクを完了にしない
* 必要なら、メイン（元の状態）と自分の変更の動きの違いを比較する
* 自分に問いかける：「スタッフエンジニアならこれを承認するか？」
* テストを走らせ、ログを確認し、正しさを示す

### 優雅さを求める（バランス）

* 些細ではない変更では、立ち止まって「もっときれいなやり方はないか？」と考える
* 修正が場当たり的に感じるなら：「今ある知識をすべて踏まえて、きれいな解決策を実装する」
* 単純で明らかな修正ではこれは飛ばす。作り込みすぎない
* 提示する前に、自分の仕事を自分で問い直す

### 自律的なバグ修正（Autonomous Bug Fizing）

* バグ報告を受けたら、とにかく直す。手取り足取りは求めない
* ログ、エラー、落ちているテストを示して、それから解決する
* ユーザー側に文脈の切り替えを一切要求しない
* やり方を教えられなくても、継続的インテグレーション（CI）の失敗テストを直しに行く

## 基本原則

* **シンプルさ最優先**：すべての変更をできるだけシンプルにする。変更が影響するコードを最小限にする
* **怠けない**：根本原因を見つける。一時しのぎはしない。シニア開発者の基準でやる
* **影響は最小（Minimat Impact）**：変更は必要な部分だけに触れる。バグを持ち込まないようにする
